(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-32be3783"],{"140a":function(t,s,a){"use strict";a.r(s);var e=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",[a("Top"),a("All")],1)},i=[],r=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"tile is-ancestor"},[a("div",{staticClass:"tile is-parent is-0-fullhd"},[a("article",{staticClass:"tile is-child box"},[a("p",{attrs:{align:"right"}},[a("button",{staticClass:"button is-info",on:{click:t.getAll}},[t._v("全部帖子")])]),a("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],staticStyle:{height:"100vh","overflow-y":"auto"},attrs:{"infinite-scroll-disabled":"busy","infinite-scroll-distance":"limit"}},[t._l(t.contents,(function(s,e){return a("div",{key:e,staticClass:"box"},[a("article",{staticClass:"media"},[a("figure",{staticClass:"media-left"},[a("p",{staticClass:"image is-64x64"},[a("img",{staticClass:"el-avatar--circle",attrs:{src:""+s.user.avatar_url,onerror:"this.src='http://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png';this.οnerrοr=null"}})])]),a("div",{staticClass:"media-content"},[a("div",{staticClass:"content"},[a("p",[a("strong",[t._v("发帖人用户名:"+t._s(s.user.user_name))]),a("br"),t._v(" 发帖标题:"+t._s(s.post_title)+" ")])]),a("nav",{staticClass:"level is-mobile"},[a("div",{staticClass:"level-left"},[a("a",{staticClass:"level-item"},[t._m(0,!0),t._v(" "+t._s(s.post_star)+" ")]),a("a",{staticClass:"level-item"},[t._m(1,!0),t._v(" "+t._s(s.post_reply)+" ")]),a("a",{staticClass:"level-item",on:{click:function(s){return t.postLike(e)}}},[t._m(2,!0),t._v(" "+t._s(s.post_like)+" ")])])])]),a("div",{staticClass:"media-right"},[a("a",{staticClass:"navbar-item",attrs:{slot:"trigger",role:"button"},slot:"trigger"},[a("b-button",{attrs:{type:"is-info",outlined:""},on:{click:function(s){return t.detail(e)}}},[t._v("查看详情")])],1)])])])})),1===t.flag?a("div",[t._v("没有更多了")]):t._e(),2===t.flag?a("b-notification",{attrs:{closable:!1}},[a("div",{staticStyle:{"text-align":"center"}},[t._v("正在加载")]),a("b-loading",{attrs:{"is-full-page":t.isFullPage,active:t.isLoading,"can-cancel":!0},on:{"update:active":function(s){t.isLoading=s}}})],1):t._e()],2)])])])},l=[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("span",{staticClass:"icon is-small"},[a("i",{staticClass:"fab fa-hotjar"})])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("span",{staticClass:"icon is-small"},[a("i",{staticClass:"fas fa-comment-dots"})])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("span",{staticClass:"icon is-small"},[a("i",{staticClass:"fas fa-heart"})])}],n=a("365c"),o=a("2c4e"),c={data(){return{search:"",isLoading:!1,isFullPage:!1,btnFlag:!1,busy:!1,limit:20,flag:0,contents:[{post_id:0,post_type:"",post_title:"",post_content:"",post_userid:0,post_star:0,post_like:0,post_reply:0,post_status:0,creat_time:"",user:{id:0,user_name:"",user_account:"",avatar_url:"",gender:0,phone:0,email:"",user_role:0,user_status:0,creat_time:"",is_delete:0,token:""}}],test:[],number:1,totalPages:5}},mounted(){Object(n["g"])(1,this.search).then(t=>{if(t.data.list.length<1){const t=this.$createElement;this.$message({message:t("p",null,[t("span",null,""),t("i",{style:"color: red"},"没有查询结果")])}),this.$router.push("/")}this.contents.shift(),this.contents=t.data.list,this.totalPages=t.data.pages,this.number=1,this.flag=0}).catch(()=>{})},methods:{postLike(t){const s=this.contents[t],a=s.post_id;Object(n["a"])(a,this.$store.state.user.token).then(t=>{2e3===t.code?(o["a"].open({message:"点赞成功!",position:"is-top"}),s.post_like+=1):o["a"].open({message:t.description,position:"is-top"})})},loadMore(){console.log("scrolling"),this.busy=!0,this.number-1===this.totalPages?(this.flag=1,this.busy=!1):(this.flag=2,this.isLoading=!0,setTimeout(()=>{Object(n["g"])(++this.number,this.search).then(t=>{const s=t.data.list;this.totalPages=t.data.pages,this.number-1!==this.totalPages&&(this.contents=this.contents.concat(s)),this.busy=!1}).catch(()=>{this.busy=!1})},1e3))},getAll(){Object(n["f"])(0).then(t=>{this.contents=t.data.list,this.totalPages=t.data.pages,this.number=1,this.flag=2}).catch(()=>{})},detail(t){const s=this.contents[t];this.$router.push({path:"/details",query:{detaildata:JSON.stringify(s)}})}},created(){this.search=JSON.parse(this.$route.query.search)}},u=c,d=(a("7a90"),a("2877")),h=Object(d["a"])(u,r,l,!1,null,"35fb8bf8",null),p=h.exports,v=a("a16d"),m={mounted(){},components:{Top:v["a"],All:p}},b=m,g=Object(d["a"])(b,e,i,!1,null,"1ed4d2c8",null);s["default"]=g.exports},"7a90":function(t,s,a){"use strict";var e=a("7ce6"),i=a.n(e);i.a},"7ce6":function(t,s,a){},a16d:function(t,s,a){"use strict";var e=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("nav",{staticClass:"navbar is-light",attrs:{role:"navigation","aria-label":"main navigation"}},[e("div",{staticClass:"navbar-brand"},[e("div",{staticClass:"demo-image"},[e("div",{staticClass:"block"},[e("el-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:a("a5d2"),fit:t.contain}})],1)]),t._m(0)]),e("div",{staticClass:"navbar-menu",attrs:{id:"navbarBasicExample"}},[e("div",{staticClass:"navbar-start"},[e("a",{staticClass:"navbar-item",on:{click:t.getMainPosts}},[t._v("首页")]),e("div",{staticClass:"navbar-item has-dropdown is-hoverable"},[e("a",{staticClass:"navbar-link"},[t._v("更多")]),e("div",{staticClass:"navbar-dropdown"},[e("a",{staticClass:"navbar-item",on:{click:t.userhome}},[t._v("个人主页")]),e("a",{staticClass:"navbar-item",on:{click:t.allart}},[t._v("全部帖子")]),e("a",{directives:[{name:"show",rawName:"v-show",value:1===t.$store.state.user.user_role,expression:"$store.state.user.user_role === 1"}],staticClass:"navbar-item",on:{click:t.manager}},[t._v("后台管理")]),e("hr",{staticClass:"navbar-divider"})])]),e("div",{staticClass:"level-left"},[t._m(1),e("div",{staticClass:"level-item"},[e("div",{staticClass:"field has-addons"},[e("p",{staticClass:"control"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.Search,expression:"Search"}],staticClass:"input",attrs:{type:"text",placeholder:"Find a post"},domProps:{value:t.Search},on:{input:function(s){s.target.composing||(t.Search=s.target.value)}}})]),e("p",{staticClass:"control"},[e("button",{staticClass:"button",on:{click:t.searchPosts}},[t._v("搜索")])])])])])]),t.$store.state.isLogin?t.$store.state.isLogin?e("div",{staticClass:"navbar-brand"},[e("div",{staticClass:"navbar-item"},[e("el-row",{attrs:{gutter:"50"}},[e("el-col",{attrs:{span:6}},[e("img",{staticClass:"el-avatar--circle",attrs:{src:""+t.$store.state.user.avatar_url,sizes:"40",onerror:"this.src='http://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png';this.οnerrοr=null"}})]),e("el-col",{attrs:{span:8}},[e("h2",[t._v(t._s(t.$store.state.user.user_name))])]),e("el-col",{attrs:{span:4}},[e("el-button",{attrs:{size:"small",round:"",type:"primary"},on:{click:t.logout}},[e("i",{staticClass:"fas fa-sign-out-alt"},[t._v("登出")])])],1)],1)],1)]):t._e():e("div",{staticClass:"navbar-end"},[e("div",{staticClass:"navbar-item"},[e("div",{staticClass:"buttons"},[e("b-button",{attrs:{type:"is-info",outlined:""},on:{click:t.register}},[t._v("注册")]),e("div",{staticClass:"navbar-menu"},[e("div",{staticClass:"navbar-end"},[e("b-dropdown",{attrs:{position:"is-bottom-left","aria-role":"menu","trap-focus":""}},[e("a",{staticClass:"navbar-item",attrs:{slot:"trigger",role:"button"},slot:"trigger"},[e("b-button",{attrs:{type:"is-info",outlined:""}},[t._v("登录")])],1),e("b-dropdown-item",{attrs:{"aria-role":"menu-item",focusable:!1,custom:"",paddingless:""}},[e("div",{staticClass:"modal-card",staticStyle:{width:"300px"}},[e("section",{staticClass:"modal-card-body"},[e("b-field",{attrs:{label:"用户账户"}},[e("b-input",{attrs:{type:"text",placeholder:"请输入您的账户",required:""},model:{value:t.userAccount,callback:function(s){t.userAccount=s},expression:"userAccount"}})],1),e("b-field",{attrs:{label:"密码"}},[e("b-input",{attrs:{type:"password","password-reveal":"",placeholder:"Your password",required:""},model:{value:t.userPassword,callback:function(s){t.userPassword=s},expression:"userPassword"}})],1),e("b-checkbox",[t._v("记住我")])],1),e("footer",{staticClass:"modal-card-foot"},[e("button",{staticClass:"button is-primary",on:{click:t.login}},[t._v("登录")])])])])],1)],1)])],1)])])])])},i=[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("a",{staticClass:"navbar-burger burger",attrs:{role:"button","aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample"}},[a("span",{attrs:{"aria-hidden":"true"}}),a("span",{attrs:{"aria-hidden":"true"}}),a("span",{attrs:{"aria-hidden":"true"}})])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"level-item"},[a("p",{staticClass:"subtitle is-5"})])}],r=a("365c"),l={data(){return{userAccount:"",userPassword:"",Search:""}},methods:{getMainPosts(){this.$router.push("/")},errorHandler(){return!0},searchPosts(){this.$router.push({path:"/allsearchhome",query:{search:JSON.stringify(this.Search)}})},allart(){this.$router.push("/allarticlehome")},manager(){this.$router.push("/backstagehome")},logout(){this.$store.commit("logout")},userhome(){this.$router.push("/userhome")},login(){Object(r["x"])(this.userAccount,this.userPassword).then(t=>{const{data:s}=t;this.user=s,console.log(s),null!=s?this.$store.dispatch("aLogin",{user:s,message:"用户登录",success:()=>{1===this.$store.state.user.user_role&&this.$router.push("backstagehome"),console.log("欢迎您")}}):alert("该用户不存在")}).catch(()=>{})},register(){this.$router.push("/registerhome")}}},n=l,o=a("2877"),c=Object(o["a"])(n,e,i,!1,null,null,null);s["a"]=c.exports},a5d2:function(t,s,a){t.exports=a.p+"img/titlelogo.73ff1d0b.png"}}]);
//# sourceMappingURL=chunk-32be3783.e3065f29.js.map